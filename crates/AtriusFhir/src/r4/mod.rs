//! FHIR R4 (4.0.1) - generated type definitions
//!
//! This module contains generated Rust types for the HL7® FHIR® R4
//! (4.0.1) specification. All types in this module are generated from the
//! official HL7 FHIR StructureDefinitions and provide comprehensive type-safe
//! access to FHIR resources, data types, and elements.
//!
//! # FHIR Version
//!
//! - **Version**: 4.0.1
//! - **Release Date**: October 30, 2019
//! - **Status**: normative+trial-use
//! - **Specification**: <http://hl7.org/fhir/R4/>
//!
//! # Contents
//!
//! This module includes:
//!
//! - **Resources**: All FHIR resource types (Patient, Observation, Bundle, etc.)
//! - **Data Types**: Complex and primitive FHIR data types
//! - **Choice Types**: Enums for polymorphic elements (e.g., value[x])
//! - **Resource Enum**: A unified `Resource` enum containing all resource types
//!
//! # Code Generation
//!
//! This file is generated using the `helios-fhir-gen` code generator.
//! Do not edit this file manually - changes will be overwritten on regeneration.
//!
//! To regenerate this file:
//! ```bash
//! cargo build -p helios-fhir-gen --features R4
//! ./target/debug/fhir_gen R4
//! ```
//!
//! # Examples
//!
//! ## Parsing a FHIR resource from JSON
//!
//! ```rust
//! # #[cfg(feature = "R4")]
//! # {
//! # fn main() -> Result<(), Box<dyn std::error::Error>> {
//! use helios_fhir::r4::Patient;
//!
//! let json = r#"{
//!     "resourceType": "Patient",
//!     "id": "example",
//!     "name": [{
//!         "family": "Smith",
//!         "given": ["John"]
//!     }]
//! }"#;
//!
//! let patient: Patient = serde_json::from_str(json)?;
//! assert_eq!(patient.id.as_ref().unwrap().value.as_ref().unwrap(), "example");
//! # Ok(())
//! # }
//! # }
//! ```
//!
//! ## Serializing a FHIR resource to JSON
//!
//! ```rust
//! # #[cfg(feature = "R4")]
//! # {
//! # fn main() -> Result<(), Box<dyn std::error::Error>> {
//! use helios_fhir::r4::{Patient, HumanName};
//!
//! let patient = Patient {
//!     id: None,
//!     name: Some(vec![HumanName {
//!         family: Some("Doe".to_string().into()),
//!         ..Default::default()
//!     }]),
//!     ..Default::default()
//! };
//!
//! let json = serde_json::to_string_pretty(&patient)?;
//! # Ok(())
//! # }
//! # }
//! ```
//!
//! ## Working with the Resource enum
//!
//! ```rust
//! # #[cfg(feature = "R4")]
//! # {
//! use helios_fhir::r4::{Resource, Patient};
//!
//! let patient = Patient::default();
//! let resource = Resource::Patient(patient);
//!
//! // Pattern matching on resource type
//! match resource {
//!     Resource::Patient(p) => println!("Found a patient"),
//!     Resource::Observation(o) => println!("Found an observation"),
//!     _ => println!("Other resource type"),
//! }
//! # }
//! ```
//!
//! # Feature Flags
//!
//! This module is only available when the `R4` feature is enabled:
//!
//! ```toml
//! [dependencies]
//! helios-fhir = { version = "*", features = ["R4"] }
//! ```
//!
//! # License
//!
//! This code is generated from the HL7® FHIR® standard specifications.
//! FHIR® is a registered trademark of Health Level Seven International (HL7).
//!
//! The FHIR specification is released under Creative Commons CC0 ("No Rights Reserved").
//! For full license details, see: <https://hl7.org/fhir/license.html>
//!
//! # Documentation Notes
//!
//! Generated documentation may contain content from HL7 FHIR specifications
//! which may include HTML-like tags and bracket notations that are not actual
//! HTML or links. Rustdoc warnings for these are suppressed below.

// Generated documentation contains content from HL7 FHIR specifications
// which may include HTML-like tags and bracket notations that are not actual HTML or links
#![allow(rustdoc::broken_intra_doc_links)]
#![allow(rustdoc::invalid_html_tags)]


use serde::{Deserialize, Serialize};
use atrius_macros::{FhirPath, FhirSerde, FhirValidate};
use crate::precise_decimal::{ DecimalElement};
use crate::element::Element;
// use crate::date_time::{PrecisionTime, PrecisionDateTime, PrecisionDate, PrecisionInstant};
// use crate::fhir_version::FhirComplexTypeProvider;

pub mod primitives;
pub mod complex_types;
pub mod resources;

pub use primitives::*;
pub use complex_types::*;
pub use resources::*;

#[derive(Debug, Serialize, Deserialize, Clone, FhirPath)]
#[serde(tag = "resourceType")]
pub enum Resource {
    Account(Account),
    ActivityDefinition(ActivityDefinition),
    AdverseEvent(AdverseEvent),
    AllergyIntolerance(AllergyIntolerance),
    Appointment(Appointment),
    AppointmentResponse(AppointmentResponse),
    AuditEvent(AuditEvent),
    Basic(Basic),
    Binary(Binary),
    BiologicallyDerivedProduct(BiologicallyDerivedProduct),
    BodyStructure(BodyStructure),
    Bundle(Bundle),
    CapabilityStatement(CapabilityStatement),
    CarePlan(CarePlan),
    CareTeam(CareTeam),
    CatalogEntry(CatalogEntry),
    ChargeItem(ChargeItem),
    ChargeItemDefinition(ChargeItemDefinition),
    Claim(Claim),
    ClaimResponse(ClaimResponse),
    ClinicalImpression(ClinicalImpression),
    CodeSystem(CodeSystem),
    Communication(Communication),
    CommunicationRequest(CommunicationRequest),
    CompartmentDefinition(CompartmentDefinition),
    Composition(Composition),
    ConceptMap(ConceptMap),
    Condition(Condition),
    Consent(Consent),
    Contract(Contract),
    Coverage(Coverage),
    CoverageEligibilityRequest(CoverageEligibilityRequest),
    CoverageEligibilityResponse(CoverageEligibilityResponse),
    DetectedIssue(DetectedIssue),
    Device(Device),
    DeviceDefinition(DeviceDefinition),
    DeviceMetric(DeviceMetric),
    DeviceRequest(DeviceRequest),
    DeviceUseStatement(DeviceUseStatement),
    DiagnosticReport(DiagnosticReport),
    DocumentManifest(DocumentManifest),
    DocumentReference(DocumentReference),
    EffectEvidenceSynthesis(EffectEvidenceSynthesis),
    Encounter(Encounter),
    Endpoint(Endpoint),
    EnrollmentRequest(EnrollmentRequest),
    EnrollmentResponse(EnrollmentResponse),
    EpisodeOfCare(EpisodeOfCare),
    EventDefinition(EventDefinition),
    Evidence(Evidence),
    EvidenceVariable(EvidenceVariable),
    ExampleScenario(ExampleScenario),
    ExplanationOfBenefit(ExplanationOfBenefit),
    FamilyMemberHistory(FamilyMemberHistory),
    Flag(Flag),
    Goal(Goal),
    GraphDefinition(GraphDefinition),
    Group(Group),
    GuidanceResponse(GuidanceResponse),
    HealthcareService(HealthcareService),
    ImagingStudy(ImagingStudy),
    Immunization(Immunization),
    ImmunizationEvaluation(ImmunizationEvaluation),
    ImmunizationRecommendation(ImmunizationRecommendation),
    ImplementationGuide(ImplementationGuide),
    InsurancePlan(InsurancePlan),
    Invoice(Invoice),
    Library(Library),
    Linkage(Linkage),
    List(List),
    Location(Location),
    Measure(Measure),
    MeasureReport(MeasureReport),
    Media(Media),
    Medication(Medication),
    MedicationAdministration(MedicationAdministration),
    MedicationDispense(MedicationDispense),
    MedicationKnowledge(MedicationKnowledge),
    MedicationRequest(MedicationRequest),
    MedicationStatement(MedicationStatement),
    MedicinalProduct(MedicinalProduct),
    MedicinalProductAuthorization(MedicinalProductAuthorization),
    MedicinalProductContraindication(MedicinalProductContraindication),
    MedicinalProductIndication(MedicinalProductIndication),
    MedicinalProductIngredient(MedicinalProductIngredient),
    MedicinalProductInteraction(MedicinalProductInteraction),
    MedicinalProductManufactured(MedicinalProductManufactured),
    MedicinalProductPackaged(MedicinalProductPackaged),
    MedicinalProductPharmaceutical(MedicinalProductPharmaceutical),
    MedicinalProductUndesirableEffect(MedicinalProductUndesirableEffect),
    MessageDefinition(MessageDefinition),
    MessageHeader(MessageHeader),
    MolecularSequence(MolecularSequence),
    NamingSystem(NamingSystem),
    NutritionOrder(NutritionOrder),
    Observation(Observation),
    ObservationDefinition(ObservationDefinition),
    OperationDefinition(OperationDefinition),
    OperationOutcome(OperationOutcome),
    Organization(Organization),
    OrganizationAffiliation(OrganizationAffiliation),
    Parameters(Parameters),
    Patient(Patient),
    PaymentNotice(PaymentNotice),
    PaymentReconciliation(PaymentReconciliation),
    Person(Person),
    PlanDefinition(PlanDefinition),
    Practitioner(Practitioner),
    PractitionerRole(PractitionerRole),
    Procedure(Procedure),
    Provenance(Provenance),
    Questionnaire(Questionnaire),
    QuestionnaireResponse(QuestionnaireResponse),
    RelatedPerson(RelatedPerson),
    RequestGroup(RequestGroup),
    ResearchDefinition(ResearchDefinition),
    ResearchElementDefinition(ResearchElementDefinition),
    ResearchStudy(ResearchStudy),
    ResearchSubject(ResearchSubject),
    RiskAssessment(RiskAssessment),
    RiskEvidenceSynthesis(RiskEvidenceSynthesis),
    Schedule(Schedule),
    SearchParameter(SearchParameter),
    ServiceRequest(ServiceRequest),
    Slot(Slot),
    Specimen(Specimen),
    SpecimenDefinition(SpecimenDefinition),
    StructureDefinition(StructureDefinition),
    StructureMap(StructureMap),
    Subscription(Subscription),
    Substance(Substance),
    SubstanceNucleicAcid(SubstanceNucleicAcid),
    SubstancePolymer(SubstancePolymer),
    SubstanceProtein(SubstanceProtein),
    SubstanceReferenceInformation(SubstanceReferenceInformation),
    SubstanceSourceMaterial(SubstanceSourceMaterial),
    SubstanceSpecification(SubstanceSpecification),
    SupplyDelivery(SupplyDelivery),
    SupplyRequest(SupplyRequest),
    Task(Task),
    TerminologyCapabilities(TerminologyCapabilities),
    TestReport(TestReport),
    TestScript(TestScript),
    ValueSet(ValueSet),
    VerificationResult(VerificationResult),
    ViewDefinition(ViewDefinition),
    VisionPrescription(VisionPrescription),
}

// Manual PartialEq implementation to break MIR optimization cycle with Bundle
impl PartialEq for Resource {
    #[inline(never)]
    fn eq(&self, other: &Self) -> bool {
        match (self, other) {
            (Self::Account(a), Self::Account(b)) => a == b,
            (Self::ActivityDefinition(a), Self::ActivityDefinition(b)) => a == b,
            (Self::AdverseEvent(a), Self::AdverseEvent(b)) => a == b,
            (Self::AllergyIntolerance(a), Self::AllergyIntolerance(b)) => a == b,
            (Self::Appointment(a), Self::Appointment(b)) => a == b,
            (Self::AppointmentResponse(a), Self::AppointmentResponse(b)) => a == b,
            (Self::AuditEvent(a), Self::AuditEvent(b)) => a == b,
            (Self::Basic(a), Self::Basic(b)) => a == b,
            (Self::Binary(a), Self::Binary(b)) => a == b,
            (Self::BiologicallyDerivedProduct(a), Self::BiologicallyDerivedProduct(b)) => a == b,
            (Self::BodyStructure(a), Self::BodyStructure(b)) => a == b,
            (Self::Bundle(a), Self::Bundle(b)) => a == b,
            (Self::CapabilityStatement(a), Self::CapabilityStatement(b)) => a == b,
            (Self::CarePlan(a), Self::CarePlan(b)) => a == b,
            (Self::CareTeam(a), Self::CareTeam(b)) => a == b,
            (Self::CatalogEntry(a), Self::CatalogEntry(b)) => a == b,
            (Self::ChargeItem(a), Self::ChargeItem(b)) => a == b,
            (Self::ChargeItemDefinition(a), Self::ChargeItemDefinition(b)) => a == b,
            (Self::Claim(a), Self::Claim(b)) => a == b,
            (Self::ClaimResponse(a), Self::ClaimResponse(b)) => a == b,
            (Self::ClinicalImpression(a), Self::ClinicalImpression(b)) => a == b,
            (Self::CodeSystem(a), Self::CodeSystem(b)) => a == b,
            (Self::Communication(a), Self::Communication(b)) => a == b,
            (Self::CommunicationRequest(a), Self::CommunicationRequest(b)) => a == b,
            (Self::CompartmentDefinition(a), Self::CompartmentDefinition(b)) => a == b,
            (Self::Composition(a), Self::Composition(b)) => a == b,
            (Self::ConceptMap(a), Self::ConceptMap(b)) => a == b,
            (Self::Condition(a), Self::Condition(b)) => a == b,
            (Self::Consent(a), Self::Consent(b)) => a == b,
            (Self::Contract(a), Self::Contract(b)) => a == b,
            (Self::Coverage(a), Self::Coverage(b)) => a == b,
            (Self::CoverageEligibilityRequest(a), Self::CoverageEligibilityRequest(b)) => a == b,
            (Self::CoverageEligibilityResponse(a), Self::CoverageEligibilityResponse(b)) => a == b,
            (Self::DetectedIssue(a), Self::DetectedIssue(b)) => a == b,
            (Self::Device(a), Self::Device(b)) => a == b,
            (Self::DeviceDefinition(a), Self::DeviceDefinition(b)) => a == b,
            (Self::DeviceMetric(a), Self::DeviceMetric(b)) => a == b,
            (Self::DeviceRequest(a), Self::DeviceRequest(b)) => a == b,
            (Self::DeviceUseStatement(a), Self::DeviceUseStatement(b)) => a == b,
            (Self::DiagnosticReport(a), Self::DiagnosticReport(b)) => a == b,
            (Self::DocumentManifest(a), Self::DocumentManifest(b)) => a == b,
            (Self::DocumentReference(a), Self::DocumentReference(b)) => a == b,
            (Self::EffectEvidenceSynthesis(a), Self::EffectEvidenceSynthesis(b)) => a == b,
            (Self::Encounter(a), Self::Encounter(b)) => a == b,
            (Self::Endpoint(a), Self::Endpoint(b)) => a == b,
            (Self::EnrollmentRequest(a), Self::EnrollmentRequest(b)) => a == b,
            (Self::EnrollmentResponse(a), Self::EnrollmentResponse(b)) => a == b,
            (Self::EpisodeOfCare(a), Self::EpisodeOfCare(b)) => a == b,
            (Self::EventDefinition(a), Self::EventDefinition(b)) => a == b,
            (Self::Evidence(a), Self::Evidence(b)) => a == b,
            (Self::EvidenceVariable(a), Self::EvidenceVariable(b)) => a == b,
            (Self::ExampleScenario(a), Self::ExampleScenario(b)) => a == b,
            (Self::ExplanationOfBenefit(a), Self::ExplanationOfBenefit(b)) => a == b,
            (Self::FamilyMemberHistory(a), Self::FamilyMemberHistory(b)) => a == b,
            (Self::Flag(a), Self::Flag(b)) => a == b,
            (Self::Goal(a), Self::Goal(b)) => a == b,
            (Self::GraphDefinition(a), Self::GraphDefinition(b)) => a == b,
            (Self::Group(a), Self::Group(b)) => a == b,
            (Self::GuidanceResponse(a), Self::GuidanceResponse(b)) => a == b,
            (Self::HealthcareService(a), Self::HealthcareService(b)) => a == b,
            (Self::ImagingStudy(a), Self::ImagingStudy(b)) => a == b,
            (Self::Immunization(a), Self::Immunization(b)) => a == b,
            (Self::ImmunizationEvaluation(a), Self::ImmunizationEvaluation(b)) => a == b,
            (Self::ImmunizationRecommendation(a), Self::ImmunizationRecommendation(b)) => a == b,
            (Self::ImplementationGuide(a), Self::ImplementationGuide(b)) => a == b,
            (Self::InsurancePlan(a), Self::InsurancePlan(b)) => a == b,
            (Self::Invoice(a), Self::Invoice(b)) => a == b,
            (Self::Library(a), Self::Library(b)) => a == b,
            (Self::Linkage(a), Self::Linkage(b)) => a == b,
            (Self::List(a), Self::List(b)) => a == b,
            (Self::Location(a), Self::Location(b)) => a == b,
            (Self::Measure(a), Self::Measure(b)) => a == b,
            (Self::MeasureReport(a), Self::MeasureReport(b)) => a == b,
            (Self::Media(a), Self::Media(b)) => a == b,
            (Self::Medication(a), Self::Medication(b)) => a == b,
            (Self::MedicationAdministration(a), Self::MedicationAdministration(b)) => a == b,
            (Self::MedicationDispense(a), Self::MedicationDispense(b)) => a == b,
            (Self::MedicationKnowledge(a), Self::MedicationKnowledge(b)) => a == b,
            (Self::MedicationRequest(a), Self::MedicationRequest(b)) => a == b,
            (Self::MedicationStatement(a), Self::MedicationStatement(b)) => a == b,
            (Self::MedicinalProduct(a), Self::MedicinalProduct(b)) => a == b,
            (Self::MedicinalProductAuthorization(a), Self::MedicinalProductAuthorization(b)) => a == b,
            (Self::MedicinalProductContraindication(a), Self::MedicinalProductContraindication(b)) => a == b,
            (Self::MedicinalProductIndication(a), Self::MedicinalProductIndication(b)) => a == b,
            (Self::MedicinalProductIngredient(a), Self::MedicinalProductIngredient(b)) => a == b,
            (Self::MedicinalProductInteraction(a), Self::MedicinalProductInteraction(b)) => a == b,
            (Self::MedicinalProductManufactured(a), Self::MedicinalProductManufactured(b)) => a == b,
            (Self::MedicinalProductPackaged(a), Self::MedicinalProductPackaged(b)) => a == b,
            (Self::MedicinalProductPharmaceutical(a), Self::MedicinalProductPharmaceutical(b)) => a == b,
            (Self::MedicinalProductUndesirableEffect(a), Self::MedicinalProductUndesirableEffect(b)) => a == b,
            (Self::MessageDefinition(a), Self::MessageDefinition(b)) => a == b,
            (Self::MessageHeader(a), Self::MessageHeader(b)) => a == b,
            (Self::MolecularSequence(a), Self::MolecularSequence(b)) => a == b,
            (Self::NamingSystem(a), Self::NamingSystem(b)) => a == b,
            (Self::NutritionOrder(a), Self::NutritionOrder(b)) => a == b,
            (Self::Observation(a), Self::Observation(b)) => a == b,
            (Self::ObservationDefinition(a), Self::ObservationDefinition(b)) => a == b,
            (Self::OperationDefinition(a), Self::OperationDefinition(b)) => a == b,
            (Self::OperationOutcome(a), Self::OperationOutcome(b)) => a == b,
            (Self::Organization(a), Self::Organization(b)) => a == b,
            (Self::OrganizationAffiliation(a), Self::OrganizationAffiliation(b)) => a == b,
            (Self::Parameters(a), Self::Parameters(b)) => a == b,
            (Self::Patient(a), Self::Patient(b)) => a == b,
            (Self::PaymentNotice(a), Self::PaymentNotice(b)) => a == b,
            (Self::PaymentReconciliation(a), Self::PaymentReconciliation(b)) => a == b,
            (Self::Person(a), Self::Person(b)) => a == b,
            (Self::PlanDefinition(a), Self::PlanDefinition(b)) => a == b,
            (Self::Practitioner(a), Self::Practitioner(b)) => a == b,
            (Self::PractitionerRole(a), Self::PractitionerRole(b)) => a == b,
            (Self::Procedure(a), Self::Procedure(b)) => a == b,
            (Self::Provenance(a), Self::Provenance(b)) => a == b,
            (Self::Questionnaire(a), Self::Questionnaire(b)) => a == b,
            (Self::QuestionnaireResponse(a), Self::QuestionnaireResponse(b)) => a == b,
            (Self::RelatedPerson(a), Self::RelatedPerson(b)) => a == b,
            (Self::RequestGroup(a), Self::RequestGroup(b)) => a == b,
            (Self::ResearchDefinition(a), Self::ResearchDefinition(b)) => a == b,
            (Self::ResearchElementDefinition(a), Self::ResearchElementDefinition(b)) => a == b,
            (Self::ResearchStudy(a), Self::ResearchStudy(b)) => a == b,
            (Self::ResearchSubject(a), Self::ResearchSubject(b)) => a == b,
            (Self::RiskAssessment(a), Self::RiskAssessment(b)) => a == b,
            (Self::RiskEvidenceSynthesis(a), Self::RiskEvidenceSynthesis(b)) => a == b,
            (Self::Schedule(a), Self::Schedule(b)) => a == b,
            (Self::SearchParameter(a), Self::SearchParameter(b)) => a == b,
            (Self::ServiceRequest(a), Self::ServiceRequest(b)) => a == b,
            (Self::Slot(a), Self::Slot(b)) => a == b,
            (Self::Specimen(a), Self::Specimen(b)) => a == b,
            (Self::SpecimenDefinition(a), Self::SpecimenDefinition(b)) => a == b,
            (Self::StructureDefinition(a), Self::StructureDefinition(b)) => a == b,
            (Self::StructureMap(a), Self::StructureMap(b)) => a == b,
            (Self::Subscription(a), Self::Subscription(b)) => a == b,
            (Self::Substance(a), Self::Substance(b)) => a == b,
            (Self::SubstanceNucleicAcid(a), Self::SubstanceNucleicAcid(b)) => a == b,
            (Self::SubstancePolymer(a), Self::SubstancePolymer(b)) => a == b,
            (Self::SubstanceProtein(a), Self::SubstanceProtein(b)) => a == b,
            (Self::SubstanceReferenceInformation(a), Self::SubstanceReferenceInformation(b)) => a == b,
            (Self::SubstanceSourceMaterial(a), Self::SubstanceSourceMaterial(b)) => a == b,
            (Self::SubstanceSpecification(a), Self::SubstanceSpecification(b)) => a == b,
            (Self::SupplyDelivery(a), Self::SupplyDelivery(b)) => a == b,
            (Self::SupplyRequest(a), Self::SupplyRequest(b)) => a == b,
            (Self::Task(a), Self::Task(b)) => a == b,
            (Self::TerminologyCapabilities(a), Self::TerminologyCapabilities(b)) => a == b,
            (Self::TestReport(a), Self::TestReport(b)) => a == b,
            (Self::TestScript(a), Self::TestScript(b)) => a == b,
            (Self::ValueSet(a), Self::ValueSet(b)) => a == b,
            (Self::VerificationResult(a), Self::VerificationResult(b)) => a == b,
            (Self::ViewDefinition(a), Self::ViewDefinition(b)) => a == b,
            (Self::VisionPrescription(a), Self::VisionPrescription(b)) => a == b,
            _ => false,
        }
    }
}

// --- From<T> Implementations for Element<T, Extension> ---
impl From<bool> for Element<bool, Extension> {
    fn from(value: bool) -> Self {
        Self {
            value: Some(value),
            ..Default::default()
        }
    }
}
impl From<std::primitive::i32> for Element<std::primitive::i32, Extension> {
    fn from(value: std::primitive::i32) -> Self {
        Self {
            value: Some(value),
            ..Default::default()
        }
    }
}
impl From<std::string::String> for Element<std::string::String, Extension> {
    fn from(value: std::string::String) -> Self {
        Self {
            value: Some(value),
            ..Default::default()
        }
    }
}
// --- End From<T> Implementations ---

// --- Type Hierarchy Module ---
/// Type hierarchy information extracted from FHIR specifications
pub mod type_hierarchy {
    use std::collections::HashMap;
    use std::sync::OnceLock;

    /// Maps FHIR type names to their parent types
    static TYPE_PARENTS: OnceLock<HashMap<&'static str, &'static str>> = OnceLock::new();

    fn get_type_parents() -> &'static HashMap<&'static str, &'static str> {
        TYPE_PARENTS.get_or_init(|| {
            let mut m = HashMap::new();
            m.insert("Account", "DomainResource");
            m.insert("ActivityDefinition", "DomainResource");
            m.insert("Address", "Element");
            m.insert("AdverseEvent", "DomainResource");
            m.insert("Age", "Quantity");
            m.insert("AllergyIntolerance", "DomainResource");
            m.insert("Annotation", "Element");
            m.insert("Appointment", "DomainResource");
            m.insert("AppointmentResponse", "DomainResource");
            m.insert("Attachment", "Element");
            m.insert("AuditEvent", "DomainResource");
            m.insert("Basic", "DomainResource");
            m.insert("Binary", "Resource");
            m.insert("BiologicallyDerivedProduct", "DomainResource");
            m.insert("BodyStructure", "DomainResource");
            m.insert("Bundle", "Resource");
            m.insert("CapabilityStatement", "DomainResource");
            m.insert("CarePlan", "DomainResource");
            m.insert("CareTeam", "DomainResource");
            m.insert("CatalogEntry", "DomainResource");
            m.insert("ChargeItem", "DomainResource");
            m.insert("ChargeItemDefinition", "DomainResource");
            m.insert("Claim", "DomainResource");
            m.insert("ClaimResponse", "DomainResource");
            m.insert("ClinicalImpression", "DomainResource");
            m.insert("CodeSystem", "DomainResource");
            m.insert("CodeableConcept", "Element");
            m.insert("Coding", "Element");
            m.insert("Communication", "DomainResource");
            m.insert("CommunicationRequest", "DomainResource");
            m.insert("CompartmentDefinition", "DomainResource");
            m.insert("Composition", "DomainResource");
            m.insert("ConceptMap", "DomainResource");
            m.insert("Condition", "DomainResource");
            m.insert("Consent", "DomainResource");
            m.insert("ContactDetail", "Element");
            m.insert("ContactPoint", "Element");
            m.insert("Contract", "DomainResource");
            m.insert("Contributor", "Element");
            m.insert("Count", "Quantity");
            m.insert("Coverage", "DomainResource");
            m.insert("CoverageEligibilityRequest", "DomainResource");
            m.insert("CoverageEligibilityResponse", "DomainResource");
            m.insert("DataRequirement", "Element");
            m.insert("DetectedIssue", "DomainResource");
            m.insert("Device", "DomainResource");
            m.insert("DeviceDefinition", "DomainResource");
            m.insert("DeviceMetric", "DomainResource");
            m.insert("DeviceRequest", "DomainResource");
            m.insert("DeviceUseStatement", "DomainResource");
            m.insert("DiagnosticReport", "DomainResource");
            m.insert("Distance", "Quantity");
            m.insert("DocumentManifest", "DomainResource");
            m.insert("DocumentReference", "DomainResource");
            m.insert("Dosage", "BackboneElement");
            m.insert("Duration", "Quantity");
            m.insert("EffectEvidenceSynthesis", "DomainResource");
            m.insert("ElementDefinition", "BackboneElement");
            m.insert("Encounter", "DomainResource");
            m.insert("Endpoint", "DomainResource");
            m.insert("EnrollmentRequest", "DomainResource");
            m.insert("EnrollmentResponse", "DomainResource");
            m.insert("EpisodeOfCare", "DomainResource");
            m.insert("EventDefinition", "DomainResource");
            m.insert("Evidence", "DomainResource");
            m.insert("EvidenceVariable", "DomainResource");
            m.insert("ExampleScenario", "DomainResource");
            m.insert("ExplanationOfBenefit", "DomainResource");
            m.insert("Expression", "Element");
            m.insert("Extension", "Element");
            m.insert("FamilyMemberHistory", "DomainResource");
            m.insert("Flag", "DomainResource");
            m.insert("Goal", "DomainResource");
            m.insert("GraphDefinition", "DomainResource");
            m.insert("Group", "DomainResource");
            m.insert("GuidanceResponse", "DomainResource");
            m.insert("HealthcareService", "DomainResource");
            m.insert("HumanName", "Element");
            m.insert("Identifier", "Element");
            m.insert("ImagingStudy", "DomainResource");
            m.insert("Immunization", "DomainResource");
            m.insert("ImmunizationEvaluation", "DomainResource");
            m.insert("ImmunizationRecommendation", "DomainResource");
            m.insert("ImplementationGuide", "DomainResource");
            m.insert("InsurancePlan", "DomainResource");
            m.insert("Invoice", "DomainResource");
            m.insert("Library", "DomainResource");
            m.insert("Linkage", "DomainResource");
            m.insert("List", "DomainResource");
            m.insert("Location", "DomainResource");
            m.insert("MarketingStatus", "BackboneElement");
            m.insert("Measure", "DomainResource");
            m.insert("MeasureReport", "DomainResource");
            m.insert("Media", "DomainResource");
            m.insert("Medication", "DomainResource");
            m.insert("MedicationAdministration", "DomainResource");
            m.insert("MedicationDispense", "DomainResource");
            m.insert("MedicationKnowledge", "DomainResource");
            m.insert("MedicationRequest", "DomainResource");
            m.insert("MedicationStatement", "DomainResource");
            m.insert("MedicinalProduct", "DomainResource");
            m.insert("MedicinalProductAuthorization", "DomainResource");
            m.insert("MedicinalProductContraindication", "DomainResource");
            m.insert("MedicinalProductIndication", "DomainResource");
            m.insert("MedicinalProductIngredient", "DomainResource");
            m.insert("MedicinalProductInteraction", "DomainResource");
            m.insert("MedicinalProductManufactured", "DomainResource");
            m.insert("MedicinalProductPackaged", "DomainResource");
            m.insert("MedicinalProductPharmaceutical", "DomainResource");
            m.insert("MedicinalProductUndesirableEffect", "DomainResource");
            m.insert("MessageDefinition", "DomainResource");
            m.insert("MessageHeader", "DomainResource");
            m.insert("Meta", "Element");
            m.insert("MolecularSequence", "DomainResource");
            m.insert("Money", "Element");
            m.insert("NamingSystem", "DomainResource");
            m.insert("Narrative", "Element");
            m.insert("NutritionOrder", "DomainResource");
            m.insert("Observation", "DomainResource");
            m.insert("ObservationDefinition", "DomainResource");
            m.insert("OperationDefinition", "DomainResource");
            m.insert("OperationOutcome", "DomainResource");
            m.insert("Organization", "DomainResource");
            m.insert("OrganizationAffiliation", "DomainResource");
            m.insert("ParameterDefinition", "Element");
            m.insert("Parameters", "Resource");
            m.insert("Patient", "DomainResource");
            m.insert("PaymentNotice", "DomainResource");
            m.insert("PaymentReconciliation", "DomainResource");
            m.insert("Period", "Element");
            m.insert("Person", "DomainResource");
            m.insert("PlanDefinition", "DomainResource");
            m.insert("Population", "BackboneElement");
            m.insert("Practitioner", "DomainResource");
            m.insert("PractitionerRole", "DomainResource");
            m.insert("Procedure", "DomainResource");
            m.insert("ProdCharacteristic", "BackboneElement");
            m.insert("ProductShelfLife", "BackboneElement");
            m.insert("Provenance", "DomainResource");
            m.insert("Quantity", "Element");
            m.insert("Questionnaire", "DomainResource");
            m.insert("QuestionnaireResponse", "DomainResource");
            m.insert("Range", "Element");
            m.insert("Ratio", "Element");
            m.insert("Reference", "Element");
            m.insert("RelatedArtifact", "Element");
            m.insert("RelatedPerson", "DomainResource");
            m.insert("RequestGroup", "DomainResource");
            m.insert("ResearchDefinition", "DomainResource");
            m.insert("ResearchElementDefinition", "DomainResource");
            m.insert("ResearchStudy", "DomainResource");
            m.insert("ResearchSubject", "DomainResource");
            m.insert("RiskAssessment", "DomainResource");
            m.insert("RiskEvidenceSynthesis", "DomainResource");
            m.insert("SampledData", "Element");
            m.insert("Schedule", "DomainResource");
            m.insert("SearchParameter", "DomainResource");
            m.insert("ServiceRequest", "DomainResource");
            m.insert("Signature", "Element");
            m.insert("Slot", "DomainResource");
            m.insert("Specimen", "DomainResource");
            m.insert("SpecimenDefinition", "DomainResource");
            m.insert("StructureDefinition", "DomainResource");
            m.insert("StructureMap", "DomainResource");
            m.insert("Subscription", "DomainResource");
            m.insert("Substance", "DomainResource");
            m.insert("SubstanceAmount", "BackboneElement");
            m.insert("SubstanceNucleicAcid", "DomainResource");
            m.insert("SubstancePolymer", "DomainResource");
            m.insert("SubstanceProtein", "DomainResource");
            m.insert("SubstanceReferenceInformation", "DomainResource");
            m.insert("SubstanceSourceMaterial", "DomainResource");
            m.insert("SubstanceSpecification", "DomainResource");
            m.insert("SupplyDelivery", "DomainResource");
            m.insert("SupplyRequest", "DomainResource");
            m.insert("Task", "DomainResource");
            m.insert("TerminologyCapabilities", "DomainResource");
            m.insert("TestReport", "DomainResource");
            m.insert("TestScript", "DomainResource");
            m.insert("Timing", "BackboneElement");
            m.insert("TriggerDefinition", "Element");
            m.insert("UsageContext", "Element");
            m.insert("ValueSet", "DomainResource");
            m.insert("VerificationResult", "DomainResource");
            m.insert("ViewDefinition", "CanonicalResource");
            m.insert("VisionPrescription", "DomainResource");
            m.insert("base64Binary", "Element");
            m.insert("boolean", "Element");
            m.insert("canonical", "uri");
            m.insert("code", "string");
            m.insert("date", "Element");
            m.insert("dateTime", "Element");
            m.insert("decimal", "Element");
            m.insert("id", "string");
            m.insert("instant", "Element");
            m.insert("integer", "Element");
            m.insert("markdown", "string");
            m.insert("oid", "uri");
            m.insert("positiveInt", "integer");
            m.insert("string", "Element");
            m.insert("time", "Element");
            m.insert("unsignedInt", "integer");
            m.insert("uri", "Element");
            m.insert("url", "uri");
            m.insert("uuid", "uri");
            m.insert("xhtml", "Element");
            m
        })
    }

    /// Checks if a type is a subtype of another type
    pub fn is_subtype_of(child: &str, parent: &str) -> bool {
        // Direct match
        if child.eq_ignore_ascii_case(parent) {
            return true;
        }

        // Walk up the type hierarchy
        let mut current = child;
        while let Some(&parent_type) = get_type_parents().get(current) {
            if parent_type.eq_ignore_ascii_case(parent) {
                return true;
            }
            current = parent_type;
        }
        false
    }

    /// Gets the parent type of a given type
    pub fn get_parent_type(type_name: &str) -> Option<&'static str> {
        get_type_parents().get(type_name).copied()
    }

    /// Gets all subtypes of a given parent type
    pub fn get_subtypes(parent: &str) -> Vec<&'static str> {
        get_type_parents().iter()
            .filter_map(|(child, p)| {
                if p.eq_ignore_ascii_case(parent) {
                    Some(*child)
                } else {
                    None
                }
            })
            .collect()
    }
}


// --- Complex Types Provider ---
/// Marker struct for complex type information
pub struct ComplexTypes;

impl crate::fhir_version::FhirComplexTypeProvider for ComplexTypes {
    fn get_complex_type_names() -> Vec<&'static str> {
        vec![
            "Address",
            "Age",
            "Annotation",
            "Attachment",
            "CodeableConcept",
            "Coding",
            "ContactDetail",
            "ContactPoint",
            "Contributor",
            "Count",
            "DataRequirement",
            "Distance",
            "Dosage",
            "Duration",
            "ElementDefinition",
            "Expression",
            "Extension",
            "HumanName",
            "Identifier",
            "MarketingStatus",
            "Meta",
            "Money",
            "Narrative",
            "ParameterDefinition",
            "Period",
            "Population",
            "ProdCharacteristic",
            "ProductShelfLife",
            "Quantity",
            "Range",
            "Ratio",
            "Reference",
            "RelatedArtifact",
            "SampledData",
            "Signature",
            "SubstanceAmount",
            "Timing",
            "TriggerDefinition",
            "UsageContext",
        ]
    }
}
