// AUTO-GENERATED by atrius-fhir-generator (R5 TriggerDefinition)
use crate::r5::*;

/// Choice of types for the timing\[x\] field in TriggerDefinition
#[derive(Debug, Clone, PartialEq, FhirSerde, FhirPath, FhirValidate)]
#[fhir_choice_element(base_name = "timing")]
pub enum TriggerDefinitionTiming {
    /// Variant accepting the Timing type.
    #[fhir_serde(rename = "timingTiming")]
    Timing(Timing),
    /// Variant accepting the Reference type.
    #[fhir_serde(rename = "timingReference")]
    Reference(Reference),
    /// Variant accepting the Date type.
    #[fhir_serde(rename = "timingDate")]
    Date(Date),
    /// Variant accepting the DateTime type.
    #[fhir_serde(rename = "timingDateTime")]
    DateTime(DateTime),
}

/// FHIR TriggerDefinition type
/// 
/// TriggerDefinition Type: A description of a triggering event. Triggering
/// events can be named events, data events, or periodic, as determined by the
/// type element.
/// 
/// ## Type: Complex-type type
/// Base type: http://hl7.org/fhir/StructureDefinition/DataType
/// 
/// ## Status: draft
/// FHIR Version: 5.0.0
/// 
/// See: [TriggerDefinition](http://hl7.org/fhir/StructureDefinition/TriggerDefinition)
#[derive(Debug, Clone, PartialEq, FhirSerde, FhirPath, Default, FhirValidate)]
#[fhir_resource(choice_elements = "timing")]
#[fhir_invariant(key="ele-1", severity="error", human="All FHIR elements must have a @value or children", expr="hasValue() or (children().count() > id.count())", path="TriggerDefinition")]
#[fhir_invariant(key="trd-1", severity="error", human="Either timing, or a data requirement, but not both", expr="data.empty() or timing.empty()", path="TriggerDefinition")]
#[fhir_invariant(key="trd-2", severity="error", human="A condition only if there is a data requirement", expr="condition.exists() implies data.exists()", path="TriggerDefinition")]
#[fhir_invariant(key="trd-3", severity="error", human="A named event requires a name, a periodic event requires timing, and a data event requires data", expr="(type = 'named-event' implies name.exists()) and (type = 'periodic' implies timing.exists()) and (type.startsWith('data-') implies data.exists())", path="TriggerDefinition")]
pub struct TriggerDefinition {
    /// Unique id for inter-element referencing
    /// 
    /// Unique id for the element within a resource (for internal references). This
    /// may be any string value that does not contain spaces.
    /// 
    /// ## Cardinality: Optional (0..1)
    /// 
    /// ## Conditions
    /// Used when: ele-1
    pub id: Option<String>,
    /// Additional content defined by implementations
    /// 
    /// May be used to represent additional information that is not part of the basic
    /// definition of the element. To make the use of extensions safe and managable,
    /// there is a strict set of governance applied to the definition and use of
    /// extensions. Though any implementer can define an extension, there is a set of
    /// requirements that SHALL be met as part of the definition of the extension.
    /// 
    /// ## Implementation Notes
    /// There can be no stigma associated with the use of extensions by any
    /// application, project, or standard - regardless of the institution or
    /// jurisdiction that uses or defines the extensions. The use of extensions is
    /// what allows the FHIR specification to retain a core level of simplicity for
    /// everyone.
    /// 
    /// ## Cardinality: Optional, Multiple (0..*)
    /// 
    /// ## Constraints
    /// - **ele-1**: All FHIR elements must have a @value or children (error)
    ///   Expression: `hasValue() or (children().count() > id.count())`
    /// - **ext-1**: Must have either extensions or value[x], not both (error)
    ///   Expression: `extension.exists() != value.exists()`
    /// 
    /// ## Aliases
    /// extensions, user content
    #[fhir_invariant(key="ele-1", severity="error", human="All FHIR elements must have a @value or children", expr="hasValue() or (children().count() > id.count())", path="TriggerDefinition.extension")]
    #[fhir_invariant(key="ext-1", severity="error", human="Must have either extensions or value[x], not both", expr="extension.exists() != value.exists()", path="TriggerDefinition.extension")]
    pub extension: Option<Vec<Extension>>,
    /// named-event | periodic | data-changed | data-added | data-modified | data-removed | data-accessed | data-access-ended
    /// 
    /// The type of triggering event.
    /// 
    /// ## Cardinality: Required (1..1)
    /// 
    /// ## Special Semantics
    /// - Included in summary
    /// 
    /// ## Constraints
    /// - **ele-1**: All FHIR elements must have a @value or children (error)
    ///   Expression: `hasValue() or (children().count() > id.count())`
    /// 
    /// ## Binding
    /// - **Strength**: required
    /// - **Description**: The type of trigger.
    /// - **ValueSet**: http://hl7.org/fhir/ValueSet/trigger-type|5.0.0
    /// 
    /// ## Conditions
    /// Used when: trd-3
    #[fhir_binding(strength="required", valueset="http://hl7.org/fhir/ValueSet/trigger-type")]
    #[fhir_invariant(key="ele-1", severity="error", human="All FHIR elements must have a @value or children", expr="hasValue() or (children().count() > id.count())", path="TriggerDefinition.type")]
    #[fhir_serde(rename = "type")]
    pub r#type: Code,
    /// Name or URI that identifies the event
    /// 
    /// A formal name for the event. This may be an absolute URI that identifies the
    /// event formally (e.g. from a trigger registry), or a simple relative URI that
    /// identifies the event in a local context.
    /// 
    /// ## Implementation Notes
    /// An event name can be provided for all event types, but is required for named
    /// events. If a name is provided for a type other than named events, it is
    /// considered to be a shorthand for the semantics described by the formal
    /// description of the event.
    /// 
    /// ## Cardinality: Optional (0..1)
    /// 
    /// ## Special Semantics
    /// - Included in summary
    /// 
    /// ## Constraints
    /// - **ele-1**: All FHIR elements must have a @value or children (error)
    ///   Expression: `hasValue() or (children().count() > id.count())`
    /// 
    /// ## Conditions
    /// Used when: trd-3
    #[fhir_invariant(key="ele-1", severity="error", human="All FHIR elements must have a @value or children", expr="hasValue() or (children().count() > id.count())", path="TriggerDefinition.name")]
    pub name: Option<String>,
    /// Coded definition of the event
    /// 
    /// A code that identifies the event.
    /// 
    /// ## Cardinality: Optional (0..1)
    /// 
    /// ## Special Semantics
    /// - Included in summary
    /// 
    /// ## Constraints
    /// - **ele-1**: All FHIR elements must have a @value or children (error)
    ///   Expression: `hasValue() or (children().count() > id.count())`
    #[fhir_invariant(key="ele-1", severity="error", human="All FHIR elements must have a @value or children", expr="hasValue() or (children().count() > id.count())", path="TriggerDefinition.code")]
    pub code: Option<CodeableConcept>,
    /// What event
    /// 
    /// A reference to a SubscriptionTopic resource that defines the event. If this
    /// element is provided, no other information about the trigger definition may be
    /// supplied.
    /// 
    /// ## Cardinality: Optional (0..1)
    /// 
    /// ## Special Semantics
    /// - Included in summary
    /// 
    /// ## Constraints
    /// - **ele-1**: All FHIR elements must have a @value or children (error)
    ///   Expression: `hasValue() or (children().count() > id.count())`
    #[fhir_invariant(key="ele-1", severity="error", human="All FHIR elements must have a @value or children", expr="hasValue() or (children().count() > id.count())", path="TriggerDefinition.subscriptionTopic")]
    #[fhir_serde(rename = "subscriptionTopic")]
    pub subscription_topic: Option<Canonical>,
    /// Timing of the event
    /// 
    /// The timing of the event (if this is a periodic trigger).
    /// 
    /// ## Cardinality: Optional (0..1)
    /// 
    /// ## Special Semantics
    /// - Included in summary
    /// 
    /// ## Constraints
    /// - **ele-1**: All FHIR elements must have a @value or children (error)
    ///   Expression: `hasValue() or (children().count() > id.count())`
    /// 
    /// ## Conditions
    /// Used when: trd-3, trd-1
    #[fhir_invariant(key="ele-1", severity="error", human="All FHIR elements must have a @value or children", expr="hasValue() or (children().count() > id.count())", path="TriggerDefinition.timing[x]")]
    #[fhir_serde(flatten)]
    pub timing: Option<TriggerDefinitionTiming>,
    /// Triggering data of the event (multiple = 'and')
    /// 
    /// The triggering data of the event (if this is a data trigger). If more than
    /// one data is requirement is specified, then all the data requirements must be
    /// true.
    /// 
    /// ## Implementation Notes
    /// This element shall be present for any data type trigger.
    /// 
    /// ## Cardinality: Optional, Multiple (0..*)
    /// 
    /// ## Special Semantics
    /// - Included in summary
    /// 
    /// ## Constraints
    /// - **ele-1**: All FHIR elements must have a @value or children (error)
    ///   Expression: `hasValue() or (children().count() > id.count())`
    /// 
    /// ## Conditions
    /// Used when: trd-3, trd-2, trd-1
    #[fhir_invariant(key="ele-1", severity="error", human="All FHIR elements must have a @value or children", expr="hasValue() or (children().count() > id.count())", path="TriggerDefinition.data")]
    pub data: Option<Vec<DataRequirement>>,
    /// Whether the event triggers (boolean expression)
    /// 
    /// A boolean-valued expression that is evaluated in the context of the container
    /// of the trigger definition and returns whether or not the trigger fires.
    /// 
    /// ## Requirements
    /// Need to be able to formally describe the triggering criteria.
    /// 
    /// ## Implementation Notes
    /// This element can be only be specified for data type triggers and provides
    /// additional semantics for the trigger. The context available within the
    /// condition is based on the type of data event. For all events, the current
    /// resource will be available as context. In addition, for modification events,
    /// the previous resource will also be available. The expression may be inlined,
    /// or may be a simple absolute URI, which is a reference to a named expression
    /// within a logic library referenced by a library element or extension within
    /// the containing resource. If the expression is a FHIR Path expression, it
    /// evaluates in the context of a resource of one of the type identified in the
    /// data requirement, and may also refer to the variable %previous for delta
    /// comparisons on events of type data-changed, data-modified, and data-deleted
    /// which will always have the same type.
    /// 
    /// ## Cardinality: Optional (0..1)
    /// 
    /// ## Special Semantics
    /// - Included in summary
    /// 
    /// ## Constraints
    /// - **ele-1**: All FHIR elements must have a @value or children (error)
    ///   Expression: `hasValue() or (children().count() > id.count())`
    /// 
    /// ## Conditions
    /// Used when: trd-2
    #[fhir_invariant(key="ele-1", severity="error", human="All FHIR elements must have a @value or children", expr="hasValue() or (children().count() > id.count())", path="TriggerDefinition.condition")]
    pub condition: Option<Expression>,
}

